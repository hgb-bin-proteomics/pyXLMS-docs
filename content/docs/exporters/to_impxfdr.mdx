import { Callout } from 'nextra/components'

# Exporting Crosslink-Spectrum-Matches and Crosslinks to IMP-X-FDR


```python copy
from pyXLMS import __version__

print(f"Installed pyXLMS version: {__version__}")
```
<Callout emoji="✓">
```
    Installed pyXLMS version: 1.5.3
```
</Callout>


```python copy
from pyXLMS import parser
from pyXLMS import exporter
```

All exporting functionality is available via the `exporter` submodule. We also import the `parser` submodule to read crosslink-spectrum-matches and crosslinks.


```python copy
parser_result = parser.read(
    "../../data/ms_annika/XLpeplib_Beveridge_QEx-HFX_DSS_R1.pdResult",
    engine="MS Annika",
    crosslinker="DSS",
)
csms = parser_result["crosslink-spectrum-matches"]
xls = parser_result["crosslinks"]
```
<Callout emoji="✓">
```
    Reading MS Annika CSMs...: 100%|████████████████████████████████████████████████████████████████████████████████| 826/826 [00:00<00:00, 10315.30it/s]
    Reading MS Annika crosslinks...: 100%|██████████████████████████████████████████████████████████████████████████| 300/300 [00:00<00:00, 15041.25it/s]
```
</Callout>

We read crosslink-spectrum-matches and crosslinks using the [generic parser](https://hgb-bin-proteomics.github.io/pyXLMS/pyXLMS.parser.html#pyXLMS.parser.read) from a single `.pdResult` file. For easier access we also assign our crosslink-spectrum-matches to the variable `csms` and our crosslinks to the variable `xls`.


```python copy
from pyXLMS.transform import validate, targets_only

csms = targets_only(validate(csms))
xls = targets_only(validate(xls))
```
<Callout emoji="✓">
```
    Iterating over scores for FDR calculation...:  15%|██████████▌                                                             | 121/826 [00:00<?, ?it/s]
    Iterating over scores for FDR calculation...:  25%|██████████████████                                                       | 74/300 [00:00<?, ?it/s]
```
</Callout>

> [!IMPORTANT]
>
> **For benchmarking purposes you would usually want to validate your crosslink-spectrum-matches and crosslinks, either externally or in this case with the pyXLMS in-built `validate()` function \[[docs](https://hgb-bin-proteomics.github.io/pyXLMS/pyXLMS.transform.html#pyXLMS.transform.validate.validate)\] to compare your estimated FDR to the "real" experimental FDR! You should also filter out any non-target matches, e.g. via the `targets_only()` function \[[docs](https://hgb-bin-proteomics.github.io/pyXLMS/pyXLMS.transform.html#pyXLMS.transform.targets_only.targets_only)\]!**


```python copy
_df = exporter.to_impxfdr(xls, filename=None)
```

The function `exporter.to_impxfdr()` exports a list of crosslinks or crosslink-spectrum-matches to [IMP-X-FDR](https://doi.org/10.1038/s41467-022-31701-w) format for benchmarking purposes. The tool IMP-X-FDR is available from [github.com/vbc-proteomics-org/imp-x-fdr](https://github.com/vbc-proteomics-org/imp-x-fdr). We recommend using version 1.1.0 and selecting `"MS Annika"` as input file format for the here exported file. A slightly modified version is available from [github.com/hgb-bin-proteomics/MSAnnika_NC_Results](https://github.com/hgb-bin-proteomics/MSAnnika_NC_Results/blob/master/Peplib_Beveridge/MS_Annika/Tools/IMP-X-FDR.v1.1.0.zip). This version contains a few bug fixes and was used for the [MS Annika 2.0](https://doi.org/10.1021/acs.jproteome.3c00325) and [MS Annika 3.0](https://doi.org/10.1038/s42004-024-01386-x) publications. Requires that `alpha_protein`, `beta_proteins`, `alpha_proteins_crosslink_positions` and `beta_proteins_crosslink_positions` fields are set for crosslinks and crosslink-spectrum-matches. You can read more about the `to_impxfdr()` function and all its parameters here: [**docs**](https://hgb-bin-proteomics.github.io/pyXLMS/pyXLMS.exporter.html#pyXLMS.exporter.to_impxfdr.to_impxfdr).

> [!TIP]
>
> **Specifying `filename=None` will only return the [pandas](https://pandas.pydata.org/) `DataFrame` and not write it to disk!**


```python copy
_df = exporter.to_impxfdr(csms, filename=None)
```

Exporting works for both crosslinks and crosslink-spectrum-matches.
